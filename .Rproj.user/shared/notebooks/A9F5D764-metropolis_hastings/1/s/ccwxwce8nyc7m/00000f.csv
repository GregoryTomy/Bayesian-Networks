"0","metropolis <- function(proposal_sd, iterations){"
"0","  x <- rep(0, iterations)"
"0","  "
"0","  for (t in 2:iterations) {"
"0","    # propose new x"
"0","    y <- rnorm(1, mean = x[t - 1], sd = proposal_sd)"
"0","    "
"0","    # compute acceptance probability"
"0","    alpha <- target(y) / target(x[t - 1])"
"0","    u <- runif(1)"
"0","    "
"0","    if (u <= alpha) {"
"0","      x[t] = y"
"0","    } else{"
"0","      x[t] = x[t - 1]"
"0","    }"
"0","  }"
"0","  "
"0","  return(x)"
"0","}"
